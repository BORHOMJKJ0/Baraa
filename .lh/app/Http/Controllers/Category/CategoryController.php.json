{
    "sourceFile": "app/Http/Controllers/Category/CategoryController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1746898297219,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1746898304241,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -95,9 +95,9 @@\n      *    ),\n      *\n      *     @OA\\Response(\n      *         response=400,\n-     *         description=\"Invalid sort column or direction. Allowed columns: name, created_at, updated_at. Allowed directions: asc, desc.\",\n+     *         description=\"Invalid sort column or direction. Allowed columns: name. Allowed directions: asc, desc.\",\n      *\n      *         @OA\\JsonContent(\n      *\n      *             @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n"
                }
            ],
            "date": 1746898297219,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Http\\Controllers\\Category;\n\nuse App\\Http\\Controllers\\Controller;\nuse App\\Http\\Requests\\Category\\CategoryCreateRequest;\nuse App\\Http\\Requests\\Category\\CategoryUpdateRequest;\nuse App\\Models\\Category\\Category;\nuse App\\Services\\Category\\CategoryService;\nuse Illuminate\\Http\\JsonResponse;\nuse Illuminate\\Http\\Request;\n\nclass CategoryController extends Controller\n{\n    public function __construct(protected CategoryService $categoryService) {}\n\n    /**\n     * @OA\\SecurityScheme(\n     *     securityScheme=\"bearerAuth\",\n     *     type=\"http\",\n     *     scheme=\"bearer\",\n     *     bearerFormat=\"JWT\",\n     *     description=\"Enter JWT Bearer token in the format 'Bearer {token}'\"\n     * )\n     */\n    /**\n     * @OA\\Get(\n     *     path=\"/categories\",\n     *     summary=\"Get list of categories\",\n     *     description=\"Retrieve a paginated list of categories with optional sorting and pagination.\",\n     *     security={{\"bearerAuth\":{}}},\n     *     tags={\"Categories\"},\n     *\n     *     @OA\\Parameter(\n     *         name=\"page\",\n     *         in=\"query\",\n     *         required=false,\n     *         description=\"Page number\",\n     *\n     *         @OA\\Schema(type=\"integer\", example=1)\n     *     ),\n     *\n     *     @OA\\Parameter(\n     *         name=\"items\",\n     *         in=\"query\",\n     *         required=false,\n     *         description=\"Number of items per page\",\n     *\n     *         @OA\\Schema(type=\"integer\", example=5)\n     *     ),\n     *\n     *     @OA\\Parameter(\n     *         name=\"direction\",\n     *         in=\"query\",\n     *         required=false,\n     *         description=\"Sorting direction (asc or desc)\",\n     *\n     *         @OA\\Schema(type=\"string\", enum={\"asc\", \"desc\"}, example=\"asc\")\n     *     ),\n     *\n     *     @OA\\Parameter(\n     *         name=\"column\",\n     *         in=\"query\",\n     *         required=false,\n     *         description=\"Column to sort by (name, created_at, updated_at)\",\n     *\n     *         @OA\\Schema(type=\"string\", enum={\"name\"}, example=\"name\")\n     *     ),\n     *\n     *     @OA\\Response(\n     *         response=200,\n     *         description=\"Categories retrieved successfully\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=true),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Categories retrieved successfully\"),\n     *             @OA\\Property(property=\"data\", type=\"object\",\n     *                @OA\\Property(property=\"Categories\", type=\"array\",\n     *\n     *                   @OA\\Items(\n     *                       type=\"object\",\n     *\n     *                        @OA\\Property(property=\"id\", type=\"integer\", example=3),\n     *                       @OA\\Property(property=\"name\", type=\"string\", example=\"blanditiis\"),\n     *                          @OA\\Property(property=\"image\", type=\"string\", example=\"http://127.0.0.1:8000/storage/images/qRERai5pFIvaN2SfoItlFqRUjlPseUwWqdnoiSsd.png\"),\n     *                    )\n     *                ),\n     *                @OA\\Property(property=\"total_pages\", type=\"integer\", example=4),\n     *               @OA\\Property(property=\"current_page\", type=\"integer\", example=1),\n     *                @OA\\Property(property=\"hasMorePages\", type=\"boolean\", example=true)\n     *            ),\n     *            @OA\\Property(property=\"status_code\", type=\"integer\", example=200)\n     *       )\n     *    ),\n     *\n     *     @OA\\Response(\n     *         response=400,\n     *         description=\"Invalid sort column or direction. Allowed columns: name, created_at, updated_at. Allowed directions: asc, desc.\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Invalid sort column or direction. Allowed columns: name, created_at, updated_at. Allowed directions: asc, desc.\"),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=400)\n     *         )\n     *     ),\n     *\n     *     @OA\\Response(\n     *         response=401,\n     *         description=\"Unauthenticated\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Unauthenticated\"),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=401)\n     *         )\n     *     )\n     * )\n     */\n    public function index(Request $request): JsonResponse\n    {\n        return $this->categoryService->getAllCategories($request);\n    }\n\n    /**\n     * @OA\\Get(\n     *     path=\"/categories/{id}\",\n     *     tags={\"Categories\"},\n     *     summary=\"Get category and its stores\",\n     *     security={{\"bearerAuth\":{}}},\n     *     description=\"Returns a category with a paginated list of stores for that category.\",\n     *\n     *     @OA\\Parameter(\n     *         name=\"id\",\n     *         in=\"path\",\n     *         required=true,\n     *         description=\"ID of the category\",\n     *\n     *         @OA\\Schema(type=\"integer\", example=12)\n     *     ),\n     *\n     *     @OA\\Parameter(\n     *         name=\"order_by\",\n     *         in=\"query\",\n     *         required=false,\n     *         description=\"Column to sort by (name, address, created_at, updated_at)\",\n     *\n     *         @OA\\Schema(type=\"string\", enum={\"name\", \"address\", \"created_at\", \"updated_at\"}, example=\"name\")\n     *     ),\n     *\n     *     @OA\\Parameter(\n     *         name=\"order_direction\",\n     *         in=\"query\",\n     *         required=false,\n     *         description=\"Sorting direction (asc or desc)\",\n     *\n     *         @OA\\Schema(type=\"string\", enum={\"asc\", \"desc\"}, example=\"asc\")\n     *     ),\n     *\n     *     @OA\\Parameter(\n     *         name=\"per_page\",\n     *         in=\"query\",\n     *         required=false,\n     *         description=\"Number of stores per page\",\n     *\n     *         @OA\\Schema(type=\"integer\", example=2)\n     *     ),\n     *\n     *     @OA\\Response(\n     *         response=200,\n     *         description=\"Category and stores retrieved successfully\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=true),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Category retrieved successfully!\"),\n     *             @OA\\Property(property=\"data\", type=\"object\",\n     *                 @OA\\Property(property=\"category\", type=\"object\",\n     *                     @OA\\Property(property=\"id\", type=\"integer\", example=12),\n     *                     @OA\\Property(property=\"name\", type=\"string\", example=\"ut\"),\n     *                          @OA\\Property(property=\"image\", type=\"string\", example=\"http://127.0.0.1:8000/storage/images/qRERai5pFIvaN2SfoItlFqRUjlPseUwWqdnoiSsd.png\"),\n     *                     @OA\\Property(property=\"stores\", type=\"object\",\n     *                         @OA\\Property(property=\"data\", type=\"array\",\n     *\n     *                             @OA\\Items(\n     *\n     *                                 @OA\\Property(property=\"id\", type=\"integer\", example=11),\n     *                                 @OA\\Property(property=\"name\", type=\"string\", example=\"Abo Bashir\"),\n     *                                 @OA\\Property(property=\"image\", type=\"string\", nullable=true, example=\"http://127.0.0.1:8000/storage/images/E5eNfLzqAhGhTaUwTgDPhHJGRKTVxSX5iEU1weyd.png\"),\n     *                                 @OA\\Property(property=\"address\", type=\"string\", example=\"Damascus\")\n     *                             )\n     *                         ),\n     *                         @OA\\Property(property=\"pagination\", type=\"object\",\n     *                             @OA\\Property(property=\"total_pages\", type=\"integer\", example=1),\n     *                             @OA\\Property(property=\"current_page\", type=\"integer\", example=1),\n     *                             @OA\\Property(property=\"hasMorePages\", type=\"boolean\", example=false)\n     *                         )\n     *                     )\n     *                 )\n     *             ),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=200)\n     *         )\n     *     ),\n     *\n     *     @OA\\Response(\n     *         response=404,\n     *         description=\"Category not found\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Category not found\"),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=404)\n     *         )\n     *     ),\n     *\n     *     @OA\\Response(\n     *         response=401,\n     *         description=\"Unauthenticated\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Unauthenticated\"),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=401)\n     *         )\n     *     ),\n     * )\n     */\n    public function show(Category $category): JsonResponse\n    {\n        return $this->categoryService->getCategoryById($category);\n    }\n\n    /**\n     * @OA\\Post(\n     *     path=\"/categories\",\n     *     tags={\"Categories\"},\n     *     summary=\"Create a new category\",\n     *     security={{\"bearerAuth\":{}}},\n     *     description=\"Creates a new category with an optional image upload.\",\n     *\n     *     @OA\\RequestBody(\n     *         required=true,\n     *\n     *         @OA\\MediaType(\n     *             mediaType=\"multipart/form-data\",\n     *\n     *             @OA\\Schema(\n     *                 type=\"object\",\n     *                 required={\"name\"},\n     *\n     *                 @OA\\Property(\n     *                     property=\"name\",\n     *                     type=\"string\",\n     *                     example=\"Abo Bashir\"\n     *                 ),\n     *                 @OA\\Property(\n     *                     property=\"image\",\n     *                     type=\"string\",\n     *                     format=\"binary\",\n     *                     nullable=true,\n     *                     description=\"Image file for the category\"\n     *                 )\n     *             )\n     *         )\n     *     ),\n     *\n     *     @OA\\Response(\n     *         response=201,\n     *         description=\"Category created successfully\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=true),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Category created successfully!\"),\n     *             @OA\\Property(property=\"data\", type=\"object\",\n     *                 @OA\\Property(property=\"Category\", type=\"object\",\n     *                     @OA\\Property(property=\"id\", type=\"integer\", example=21),\n     *                     @OA\\Property(property=\"name\", type=\"string\", example=\"Abo Bashir\"),\n     *                          @OA\\Property(property=\"image\", type=\"string\", example=\"http://127.0.0.1:8000/storage/images/qRERai5pFIvaN2SfoItlFqRUjlPseUwWqdnoiSsd.png\"),\n     *                 )\n     *             ),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=201)\n     *         )\n     *     ),\n     *\n     *     @OA\\Response(\n     *         response=400,\n     *         description=\"Validation failed\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Validation failed\"),\n     *             @OA\\Property(property=\"data\", type=\"object\",\n     *                 @OA\\Property(property=\"name\", type=\"string\", example=\"The name field is required.\")\n     *             ),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=400)\n     *         )\n     *     ),\n     *\n     *     @OA\\Response(\n     *         response=401,\n     *         description=\"Unauthenticated\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Unauthenticated\"),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=401)\n     *         )\n     *     )\n     * )\n     */\n    public function store(CategoryCreateRequest $request): JsonResponse\n    {\n        return $this->categoryService->createCategory($request->validated(), $request);\n    }\n\n    /**\n     * @OA\\Post(\n     *     path=\"/categories/{id}\",\n     *     tags={\"Categories\"},\n     *     summary=\"Update a category\",\n     *     security={{\"bearerAuth\":{}}},\n     *     description=\"Update a category's name and optional image. Requires authentication.\",\n     *\n     *     @OA\\Parameter(\n     *         name=\"id\",\n     *         in=\"path\",\n     *         required=true,\n     *         description=\"ID of the category to update\",\n     *\n     *         @OA\\Schema(type=\"integer\", example=12)\n     *     ),\n     *\n     *     @OA\\RequestBody(\n     *         required=true,\n     *\n     *         @OA\\MediaType(\n     *             mediaType=\"multipart/form-data\",\n     *\n     *             @OA\\Schema(\n     *                 type=\"object\",\n     *\n     *                 @OA\\Property(\n     *                     property=\"name\",\n     *                     type=\"string\",\n     *                     example=\"Vegetables\"\n     *                 ),\n     *                 @OA\\Property(\n     *                     property=\"image\",\n     *                     type=\"string\",\n     *                     format=\"binary\",\n     *                     nullable=true,\n     *                     description=\"Optional image file for the category\"\n     *                 )\n     *             )\n     *         )\n     *     ),\n\n     *\n     *     @OA\\Response(\n     *         response=200,\n     *         description=\"Category updated successfully\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=true),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Category updated successfully!\"),\n     *             @OA\\Property(property=\"data\", type=\"object\",\n     *                 @OA\\Property(property=\"Category\", type=\"object\",\n     *                     @OA\\Property(property=\"id\", type=\"integer\", example=12),\n     *                     @OA\\Property(property=\"name\", type=\"string\", example=\"Vegetables\"),\n     *                          @OA\\Property(property=\"image\", type=\"string\", example=\"http://127.0.0.1:8000/storage/images/qRERai5pFIvaN2SfoItlFqRUjlPseUwWqdnoiSsd.png\"),\n     *                 )\n     *             ),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=200)\n     *         )\n     *     ),\n     *\n     *      @OA\\Response(\n     *          response=403,\n     *          description=\"Unauthorized to update - category has associated stores\",\n     *\n     *          @OA\\JsonContent(\n     *\n     *              @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *              @OA\\Property(property=\"message\", type=\"string\", example=\"You are not authorized to update this Category. It has associated Stores.\"),\n     *              @OA\\Property(property=\"status_code\", type=\"integer\", example=403)\n     *          )\n     *      ),\n     *\n     *     @OA\\Response(\n     *         response=404,\n     *         description=\"Category not found\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Category not found\"),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=404)\n     *         )\n     *     ),\n\n     *\n     *     @OA\\Response(\n     *         response=401,\n     *         description=\"Unauthenticated\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Unauthenticated\"),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=401)\n     *         )\n     *     )\n     * )\n     */\n    public function update(CategoryUpdateRequest $request, Category $category): JsonResponse\n    {\n        return $this->categoryService->updateCategory($category, $request->validated());\n    }\n\n    /**\n     * @OA\\Delete(\n     *     path=\"/categories/{id}\",\n     *     tags={\"Categories\"},\n     *     summary=\"Delete a category\",\n     *     security={{\"bearerAuth\":{}}},\n     *     description=\"Delete a category by its ID. Requires authentication.\",\n     *\n     *     @OA\\Parameter(\n     *         name=\"id\",\n     *         in=\"path\",\n     *         required=true,\n     *         description=\"ID of the category to delete\",\n     *\n     *         @OA\\Schema(type=\"integer\", example=12)\n     *     ),\n     *\n     *     @OA\\Response(\n     *         response=200,\n     *         description=\"Category deleted successfully\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=true),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Category deleted successfully!\"),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=200)\n     *         )\n     *     ),\n     *\n     *     @OA\\Response(\n     *         response=404,\n     *         description=\"Category not found\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Category not found\"),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=404)\n     *         )\n     *     ),\n     *\n     *      @OA\\Response(\n     *          response=403,\n     *          description=\"Unauthorized to delete - category has associated stores\",\n     *\n     *          @OA\\JsonContent(\n     *\n     *              @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *              @OA\\Property(property=\"message\", type=\"string\", example=\"You are not authorized to delete this Category. It has associated Stores.\"),\n     *              @OA\\Property(property=\"status_code\", type=\"integer\", example=403)\n     *          )\n     *      ),\n     *\n     *     @OA\\Response(\n     *         response=401,\n     *         description=\"Unauthenticated\",\n     *\n     *         @OA\\JsonContent(\n     *\n     *             @OA\\Property(property=\"successful\", type=\"boolean\", example=false),\n     *             @OA\\Property(property=\"message\", type=\"string\", example=\"Unauthenticated\"),\n     *             @OA\\Property(property=\"status_code\", type=\"integer\", example=401)\n     *         )\n     *     )\n     * )\n     */\n    public function destroy(Category $category): JsonResponse\n    {\n        return $this->categoryService->deleteCategory($category);\n    }\n}"
        }
    ]
}